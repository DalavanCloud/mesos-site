<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Apache Mesos: versioning</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Apache Mesos
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">versioning </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
 <h2>layout: documentation </h2>
<h1>Mesos Versioning</h1>
<p>The Mesos API and release versioning policy gives operators and developers clear guidelines on:</p>
<ul>
<li>Making modifications to the existing APIs without affecting backward compatibility.</li>
<li>How long a Mesos API will be supported.</li>
<li>Upgrading the Mesos installation across release versions.</li>
</ul>
<p>API versioning was introduced in Mesos 0.24.0 and this scheme only applies to Mesos 1.0.0 and higher.</p>
<h2>Terminology</h2>
<ul>
<li><b>Release Versioning</b>: This refers to the version of Mesos that is being released. It is of the form <b>Mesos X.Y.Z</b> (X is the major version, Y is the minor version, and Z is the patch version).</li>
<li><b>API Versioning</b>: This refers to the version of the Mesos API. It is of the form <b>vX</b> (X is the major version).</li>
</ul>
<h2>How does it work?</h2>
<p>The Mesos APIs (constituting Scheduler, Executor, Internal, Operator/Admin APIs) will have a version in the URL. The versioned URL will have a prefix of **<code>/api/vN</code>** where "N" is the version of the API. The "/api" prefix is chosen to distinguish API resources from Web UI paths.</p>
<p>Examples:</p>
<ul>
<li><a href="http://localhost:5050/api/v1/scheduler">http://localhost:5050/api/v1/scheduler</a> : Scheduler HTTP API hosted by the master.</li>
<li><a href="http://localhost:5051/api/v1/executor">http://localhost:5051/api/v1/executor</a> : Executor HTTP API hosted by the agent.</li>
</ul>
<p>A given Mesos installation might host multiple versions of the same API i.e., Scheduler API v1 and/or v2 etc.</p>
<h3>API version vs Release version</h3>
<ul>
<li>To keep things simple, the stable version of the API will correspond to the major release version of Mesos.<ul>
<li>For example, v1 of the API will be supported by Mesos release versions 1.0.0, 1.4.0, 1.20.0 etc.</li>
</ul>
</li>
<li>vN version of the API might also be supported by release versions of N-1 series but the vN API is not considered stable until the last release version of N-1 series.<ul>
<li>For example, v2 of the API might be introduced in Mesos 1.12.0 release but it is only considered stable in Mesos 1.21.0 release if it is the last release of “1” series. Note that all Mesos 1.x.y versions will still support v1 of the API.</li>
</ul>
</li>
<li>The API version is only bumped if we need to make a backwards <a href="#api-compatibility">incompatible</a> API change. We will strive to support a given API version for at least a year.</li>
<li>The deprecation clock for vN-1 API will start as soon as we release “N.0.0” version of Mesos. We will strive to give enough time (e.g., 6 months) for frameworks/operators to upgrade to vN API before we stop supporting vN-1 API.</li>
<li>Minor release version is bumped roughly on a monthly cycle to give a cadence of new features to users.</li>
</ul>
<p>NOTE: Presently, for "0.X.Y" releases i.e. till we reach "1.0.0", we wait for at least 6 monthly releases before deprecating functionality. So, functionality that has been deprecated in 0.26.0 can be safely removed in 0.32.0.</p>
<h3>API Compatibility</h3>
<p>The API compatibility is determined by the corresponding protobuf guarantees.</p>
<p>As an example, the following are considered "backwards compatible" changes for Scheduler API:</p>
<ul>
<li>Adding new types of Calls i.e., new types of HTTP requests to "/scheduler".</li>
<li>Adding new optional fields to existing requests to "/scheduler".</li>
<li>Adding new types of Events i.e., new types of chunks streamed on "/scheduler".</li>
<li>Adding new header fields to chunked response streamed on "/scheduler".</li>
<li>Adding new fields (or changing the order of fields) to chunks’ body streamed on "/scheduler".</li>
<li>Adding new API resources (e.g., "/foobar").</li>
</ul>
<p>The following are considered backwards incompatible changes for Scheduler API:</p>
<ul>
<li>Adding new required fields to existing requests to "/scheduler".</li>
<li>Renaming/removing fields from existing requests to "/scheduler".</li>
<li>Renaming/removing fields from chunks streamed on "/scheduler".</li>
<li>Renaming/removing existing Calls.</li>
</ul>
<h2>Upgrades</h2>
<ul>
<li>The master and agent are typically compatible as long as they are running the same major version.<ul>
<li>For example, 1.3.0 master is compatible with 1.13.0 agent.</li>
</ul>
</li>
<li>In rare cases, we might require the master and agent to go through a specific minor version for upgrades.<ul>
<li>For example, we might require that a 1.1.0 master (and/or agent) be upgraded to 1.8.0 before it can be upgraded to 1.9.0 or later versions.</li>
</ul>
</li>
</ul>
<p>The detailed information about upgrading to a particular Mesos version would be posted <a class="el" href="upgrades_8md.html">here</a>.</p>
<h3>Implementation Details</h3>
<p>Most APIs in Mesos accept protobuf messages with a corresponding <a class="el" href="namespaceJSON.html">JSON</a> field mapping. To support multiple versions of the API, we decoupled the versioned protobufs backing the API from the “internal” protobufs used by the Mesos code.</p>
<p>For example, the protobufs for the v1 Scheduler API are located at:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;include/mesos/v1/scheduler/scheduler.proto</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;package mesos.v1.scheduler;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;option java_package = &quot;org.apache.mesos.v1.scheduler&quot;;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;option java_outer_classname = &quot;Protos&quot;;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;…</div></div><!-- fragment --><p>The corresponding internal protobufs for the Scheduler API are located at:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;include/mesos/scheduler/scheduler.proto</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;package mesos.scheduler;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;option java_package = &quot;org.apache.mesos.scheduler&quot;;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;option java_outer_classname = &quot;Protos&quot;;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;…</div></div><!-- fragment --><p>The users of the API send requests (and receive responses) based on the versioned protobufs. We implemented <a href="https://github.com/apache/mesos/blob/master/src/internal/evolve.hpp">evolve</a>/<a href="https://github.com/apache/mesos/blob/master/src/internal/devolve.hpp">devolve</a> converters that can convert protobufs from any supported version to the internal protobuf and vice versa.</p>
<p>Internally, message passing between various Mesos components would use the internal unversioned protobufs. When sending response (if any) back to the user of the API, the unversioned protobuf would be converted back to a versioned protobuf. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>

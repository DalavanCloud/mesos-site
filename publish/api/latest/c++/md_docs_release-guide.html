<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Apache Mesos: release-guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Apache Mesos
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">release-guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
 <h2>layout: documentation </h2>
<h1>Release Guide</h1>
<p>This guide describes the process of doing an official release of Mesos. </p><hr/>
<h2>Prerequisites</h2>
<ol type="1">
<li>Ensure that you have a GPG key or generate a new one, e.g., using <code>gpg --gen-key</code>.</li>
<li>Add your GPG public key to the Apache Mesos dist repository in the KEYS file.<ul>
<li>Fetch the svn repository:<br />
 <code>svn co <a href="https://dist.apache.org/repos/dist/release/mesos">https://dist.apache.org/repos/dist/release/mesos</a></code></li>
<li>Append your public key using one of methods described in KEYS, e.g.,<br />
 <code>(gpg --list-sigs &lt;your name&gt; &amp;&amp; gpg --armor --export &lt;your name&gt;) &gt;&gt; KEYS</code>.</li>
<li>Push the commit:<br />
 <code>svn ci</code></li>
</ul>
</li>
<li>Submit your GPG public key to a keyserver, e.g., <a href="https://pgp.mit.edu">MIT PGP Public Key Server</a>.</li>
<li>Add your GPG fingerprint to your <a href="https://id.apache.org/">Apache account</a>.</li>
<li>Create a Maven settings file (<code>~/.m2/settings.xml</code>) for the Apache servers where you must copy your encrypted Apache password which you can get from running <code>mvn --encrypt-password</code> (NOTE: you may need to first generate a <a href="http://maven.apache.org/guides/mini/guide-encryption.html">master password</a>. <pre class="fragment"> &lt;settings&gt;
   &lt;servers&gt;
     &lt;server&gt;
       &lt;id&gt;apache.snapshots.https&lt;/id&gt;
       &lt;username&gt;APACHE USERNAME&lt;/username&gt;
       &lt;password&gt;APACHE ENCRYPTED PASSWORD&lt;/password&gt;
     &lt;/server&gt;
     &lt;server&gt;
       &lt;id&gt;apache.releases.https&lt;/id&gt;
       &lt;username&gt;APACHE USERNAME&lt;/username&gt;
       &lt;password&gt;APACHE ENCRYPTED PASSWORD&lt;/password&gt;
     &lt;/server&gt;
   &lt;/servers&gt;
 &lt;/settings&gt;
</pre></li>
<li>Use <code>gpg-agent</code> to avoid typing your passphrase repeatedly.</li>
</ol>
<h2>Preparation</h2>
<ol type="1">
<li><p class="startli">Go to <a href="https://issues.apache.org/jira/browse/MESOS">Apache Jira</a> and make sure that the CHANGELOG for the release version is up to date.</p>
<p class="startli">&gt; NOTE: You should move all <b>Unresolved</b> tickets marked with <code>Fix <a class="el" href="structVersion.html">Version</a></code> or <code>Target <a class="el" href="structVersion.html">Version</a></code> as the release version to the next release version.</p>
<p class="startli">&gt; PROTIP: Use a JIRA dashboard <a href="https://issues.apache.org/jira/secure/Dashboard.jspa?selectPageId=12326227">(example)</a> to track the progress of targeted issues as the release date approaches.</p>
<p class="startli">&gt; PROTIP: Use <code>bulk edit</code> option in JIRA to move the tickets and make sure to <b>uncheck</b> the option that emails everyone about the move.</p>
</li>
<li><p class="startli">Update and commit the <code>CHANGELOG</code> for the release. For major releases we like to call out any major features, API changes, or deprecations.</p>
<p class="startli">&gt; NOTE: You should use JIRA to generate the CHANGELOG for you. Click on the release version in <a href="https://issues.apache.org/jira/browse/MESOS#selectedTab=com.atlassian.jira.plugin.system.project%3Aversions-panel">JIRA</a> and click on the <code>Release Notes</code>. Make sure to configure the release notes in text format.</p>
<p class="startli">&gt; NOTE: The JIRA Release Notes will list only tickets with <code>Fix <a class="el" href="structVersion.html">Version</a></code> set to that version. You should check for any Resolved tickets that have <code>Target <a class="el" href="structVersion.html">Version</a></code> set but not <code>Fix <a class="el" href="structVersion.html">Version</a></code>. Also check for any Unresolved or <code>Duplicate</code>/<code>Invalid</code> tickets that incorrectly set the <code>Fix <a class="el" href="structVersion.html">Version</a></code>.</p>
</li>
<li>If not already done, update and commit <code>configure.ac</code> for the release.</li>
<li>Update and commit <code><a class="el" href="configuration_8md.html">docs/configuration.md</a></code> to reflect the current state of the master, slave, and configure flags.</li>
<li>Update and commit <code><a class="el" href="upgrades_8md.html">docs/upgrades.md</a></code> with instructions about how to upgrade a live cluster from the previous release version to this release version.</li>
<li>If this is a major release, please ensure that user documentation has been added for any new features.</li>
<li>Make sure that for any updates of the API, specifically the scheduler API, the public mesos protobuf definitions are part of both, <code>include/mesos</code> as well as <code>include/mesos/v1</code>. NOTE: This might actually demand code updates if any omissions were identified.</li>
</ol>
<h2>Tagging the release candidate</h2>
<ol type="1">
<li>Ensure that you can build and pass all the tests. <pre class="fragment"> $ sudo make -j&lt;cores&gt; distcheck
</pre></li>
<li>Run the benchmarks and compare with the previous release for any performance regressions: <pre class="fragment"> $ make bench -j&lt;cores&gt; GTEST_FILTER="*BENCHMARK*"
</pre></li>
<li><p class="startli">First tag the required SHA locally. </p><pre class="fragment"> $ git tag &lt;X.Y.Z-rcR&gt;
</pre><p class="startli">&gt; NOTE: <code>X.Y.Z</code> is based on <a href="http://semver.org/">semantic versioning</a> scheme. <code>R</code> is release candidate version that starts with 1.</p>
</li>
<li><p class="startli">Tag the release externally and deploy the corresponding JAR to the Apache maven repository. It is recommended to use the <code>support/tag.sh</code> script to accomplish this. </p><pre class="fragment"> $ ./support/tag.sh X.Y.Z R
</pre><p class="startli">&gt; NOTE: This script assumes that you have the requisite permissions to deploy the JAR. For instructions on how to set it up, please refer to <code>src/java/MESOS-MAVEN-README</code>.</p>
<p class="startli">&gt; NOTE: gnu-sed (Linux) requires `-i''<code>instead of the</code>-i ''` (space-separated) that default OSX uses. You may need to modify your local copy of tag.sh for it to complete successfully.</p>
</li>
<li>It is not uncommon to release multiple release candidates, with increasing release candidate version, if there are bugs found.</li>
<li>Update to the <em>next</em> Mesos version in <code>configure.ac</code>: change <code>AC_INIT([mesos], [X.Y.Z]))</code>, as well as in <code>CMakeLists.txt</code>: change <code>set(MESOS_MAJOR_VERSION X)</code>, <code>set(MESOS_MINOR_VERSION Y)</code>, <code>set(MESOS_PATCH_VERSION Z)</code> and then commit.</li>
</ol>
<h2>Voting the release candidate</h2>
<ol type="1">
<li>Once a release candidate is deemed worthy to be officially released you should call a vote on the <code>dev@mesos.apache.org</code> (and optionally <code>user@mesos.apache.org</code>) mailing list.</li>
<li>It is recommended to use the <code>support/vote.sh</code> script to vote the release candidate. <pre class="fragment"> $ ./support/vote.sh X.Y.Z R
</pre></li>
<li><p class="startli">The release script also spits out an email template that you could use to send the vote email.</p>
<p class="startli">&gt; NOTE: The <code>date -v+3d</code> command does not work on some platforms (e.g. Ubuntu), so you may need to fill in the vote end date manually. The vote should last for 3 business days instead of 3 calendar days anyway. Sometimes we prefer a weeklong vote, to allow more time for integration testing.</p>
</li>
</ol>
<h2>Preparing a new release candidate</h2>
<ol type="1">
<li>If the vote does not pass (any -1s or showstopper bugs), track the issues as new JIRAs for the release.</li>
<li>When all known issues are resolved, update the CHANGELOG with the newly fixed JIRAs.</li>
<li>Once all patches are committed to master, cherry-pick them on top of the previous release candidate tag. This is the same process used for point releases (e.g. 0.22.1) as well. <pre class="fragment"> $ git checkout X.Y.Z-rcR
 $ git cherry-pick abcdefgh...
</pre></li>
<li>Now go back up to the "Tagging the release candidate" section and repeat.</li>
</ol>
<h2>Releasing the release candidate</h2>
<ol type="1">
<li>You should only release an official version if the vote passes with at least <b>3 +1 binding votes and no -1 votes</b>. For more information, please refer to <a href="http://www.apache.org/dev/release.html">Apache release guidelines</a>.</li>
<li>It is recommended to use <code>support/release.sh</code> script to release the candidate. <pre class="fragment"> $ ./support/release.sh X.Y.Z R
</pre></li>
<li><p class="startli">The release script also spits out an email template that you could use to notify the mailing lists about the result of the vote and the release.</p>
<p class="startli">&gt; NOTE: Make sure you fill the email template with the names of binding voters.</p>
</li>
</ol>
<h2>Updating the website</h2>
<ol type="1">
<li>After a successful release, please update the website pointing to the new release. See our <a href="http://svn.apache.org/repos/asf/mesos/site/">website README</a> and the general <a href="https://www.apache.org/dev/project-site.html">Apache project website guide</a> for details on how to build and publish the website. <pre class="fragment"> $ svn co https://svn.apache.org/repos/asf/mesos/site mesos-site
</pre></li>
<li>Write a blog post announcing the new release and its features and major bug fixes.</li>
<li>Update the Getting Started guide to use the latest release link.</li>
</ol>
<h2>Remove old releases from svn</h2>
<p>Per the guidelines <a href="http://www.apache.org/dev/release.html#when-to-archive">when to archive</a>, we should only keep the latest release in each version under development.</p>
<ol type="1">
<li>Checkout the mesos distribution folder: <code>svn co <a href="https://dist.apache.org/repos/dist/release/mesos">https://dist.apache.org/repos/dist/release/mesos</a></code></li>
<li>Remove all minor versions that are no longer under development and commit the change.</li>
</ol>
<h2><a class="el" href="classSet.html">Set</a> the release date</h2>
<ol type="1">
<li>Find the released Mesos version on <a href="https://issues.apache.org/jira/plugins/servlet/project-config/MESOS/versions,">https://issues.apache.org/jira/plugins/servlet/project-config/MESOS/versions,</a> and "release" it with the correct release date.</li>
</ol>
<h2>Update external tooling</h2>
<p>Upload the mesos.interface package to PyPi.</p>
<ol type="1">
<li>Create/use a PyPi account with access to the <a href="https://pypi.python.org/pypi?name=mesos.interface&amp;:action=submit_form">mesos.interface submit form</a>. You may need to ask a current package owner to add you as an owner/maintainer.</li>
</ol>
<ol type="1">
<li>Setup your <a href="https://docs.python.org/2/distutils/packageindex.html#pypirc"><code>~/.pypirc</code></a> with your PyPi username and password.</li>
</ol>
<ol type="1">
<li>After a successful Mesos <code>make</code> (any architecture), cd to <code>build/src/python/interface</code>.</li>
</ol>
<ol type="1">
<li>Run <code>python setup.py register</code> to register this package.</li>
</ol>
<ol type="1">
<li>Run <code>python setup.py sdist bdist_egg upload</code> to upload the source distribution and egg for this package.</li>
</ol>
<p>Update the Mesos Homebrew package.</p>
<ol type="1">
<li>Update the <a href="https://github.com/Homebrew/homebrew/blob/master/Library/Formula/mesos.rb">Homebrew formula for Mesos</a> and test.</li>
</ol>
<ol type="1">
<li>Submit a PR to the <a href="https://github.com/Homebrew/homebrew">Homebrew repo</a>.</li>
</ol>
<ol type="1">
<li>Once accepted, verify that <code>brew install mesos</code> works. </li>
</ol>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>

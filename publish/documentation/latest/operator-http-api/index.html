<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Apache Mesos - Operator HTTP API</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:locale" content="en_US"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Apache Mesos"/>
    <meta property="og:site_name" content="Apache Mesos"/>
    <meta property="og:url" content="http://mesos.apache.org/"/>
    <meta property="og:image" content="http://mesos.apache.org/assets/img/mesos_logo_fb_preview.png"/>
    <meta property="og:description"
          content="Apache Mesos abstracts resources away from machines,
                   enabling fault-tolerant and elastic distributed systems
                   to easily be built and run effectively."/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ApacheMesos"/>
    <meta name="twitter:title" content="Apache Mesos"/>
    <meta name="twitter:image" content="http://mesos.apache.org/assets/img/mesos_logo_fb_preview.png"/>
    <meta name="twitter:description"
          content="Apache Mesos abstracts resources away from machines,
                   enabling fault-tolerant and elastic distributed systems
                   to easily be built and run effectively."/>

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <link rel="alternate" type="application/atom+xml" title="Apache Mesos Blog" href="/blog/feed.xml">
    <link href="../../../assets/css/main.css" media="screen" rel="stylesheet" type="text/css" />

    

    <!-- Google Analytics Magic -->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-20226872-1']);
    _gaq.push(['_setDomainName', 'apache.org']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    
  </head>
  <body>
    <!-- magical breadcrumbs -->
    <div class="topnav">
      <div class="container">
        <ul class="breadcrumb">
          <li>
            <div class="dropdown">
              <a data-toggle="dropdown" href="#">Apache Software Foundation <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                <li><a href="http://www.apache.org">Apache Homepage</a></li>
                <li><a href="http://www.apache.org/licenses/">License</a></li>
                <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                <li><a href="http://www.apache.org/security/">Security</a></li>
              </ul>
            </div>
          </li>

          <li><a href="http://mesos.apache.org">Apache Mesos</a></li>
          
          
          <li><a href="/documentation
/">Documentation
</a></li>
          
          
        </ul><!-- /.breadcrumb -->
      </div><!-- /.container -->
    </div><!-- /.topnav -->

    <!-- navbar excitement -->
<div class="navbar navbar-default navbar-static-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mesos-menu" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><img src="/assets/img/mesos_logo.png" alt="Apache Mesos logo"/></a>
    </div><!-- /.navbar-header -->

    <div class="navbar-collapse collapse" id="mesos-menu">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/gettingstarted/">Getting Started</a></li>
        <li><a href="/blog/">Blog</a></li>
        <li><a href="/documentation/latest/">Documentation</a></li>
        <li><a href="/downloads/">Downloads</a></li>
        <li><a href="/community/">Community</a></li>
      </ul>
    </div><!-- /#mesos-menu -->
  </div><!-- /.container -->
</div><!-- /.navbar -->

<div class="content">
  <div class="container">
    <div class="row-fluid">
  <div class="col-md-4">
    <h4>If you're new to Mesos</h4>
    <p>See the <a href="/gettingstarted/">getting started</a> page for more
       information about downloading, building, and deploying Mesos.</p>

    <h4>If you'd like to get involved or you're looking for support</h4>
    <p>See our <a href="/community/">community</a> page for more details.</p>
  </div>
  <div class="col-md-8">
    <h1>Operator HTTP API</h1>

<p>Mesos 1.0.0 added <strong>experimental</strong> support for v1 Operator HTTP API.</p>

<h2>Overview</h2>

<p>The base URL at <code>/api/v1</code> is utilized as the single endpoint on both masters and agents for performing operator related operations.</p>

<p>Similar to the <a href="/documentation/latest/./scheduler-http-api/">Scheduler</a> and <a href="/documentation/latest/./executor-http-api/">Executor</a> HTTP APIs, the endpoints only accept HTTP POST requests. The request body should be encoded in JSON (<strong>Content-Type: application/json</strong>) or protobuf (<strong>Content-Type: application/x-protobuf</strong>).</p>

<p>For requests that Mesos can answer synchronously and immediately, an HTTP response with status <strong>200 OK</strong>, possibly including response body encoded in JSON or Protobuf is sent. The encoding depends on the <strong>Accept</strong> header present in the request (default is JSON). Also, note that responses will be gzip compressed if <strong>Accept-Encoding</strong> header is set to &ldquo;gzip&rdquo;.</p>

<p>For requests that require the master to process the request asynchronously (e.g., <code>RESERVE_RESOURCES</code>), an HTTP response with status <strong>202 Accepted</strong> is sent. For the requests that result in a never ending stream of events (<code>SUBSCRIBE</code>), a streaming HTTP response with <a href="/documentation/latest/./scheduler-http-api/#recordio-response-format">RecordIO</a> encoding is sent. Currently, gzip compression is not supported for streaming response.</p>

<h2>Master API</h2>

<p>This API contains all the calls accepted by the master. The canonical source of this information is <a href="https://github.com/apache/mesos/blob/master/include/mesos/v1/master/master.proto">master.proto</a> (NOTE: The protobuf definitions are subject to change before the beta API is finalized). These calls are typically made by human operators, tooling or services (e.g., Mesos WebUI). While schedulers can make these calls as well, it is expected for those to use the <a href="/documentation/latest/./scheduler-http-api/">Scheduler HTTP API</a>.</p>

<h2>Agent API</h2>

<p>This API contains all the calls accepted by the agent. The canonical source of this information is <a href="https://github.com/apache/mesos/blob/master/include/mesos/v1/agent/agent.proto">agent.proto</a> (NOTE: The protobuf definitions are subject to change before the beta API is finalized). These calls are typically made by human operators, tooling or services (e.g., Mesos WebUI). While executors can make these calls as well, it is expected for those to use the <a href="/documentation/latest/./executor-http-api/">Executor HTTP API</a>.</p>

<h2>Calls and Responses</h2>

<p>Below are some example calls that result in synchronous responses from the API.</p>

<h3>GET_VERSION</h3>

<pre><code>GET_VERSION HTTP Request (JSON):

POST /api/v1/  HTTP/1.1

Host: masterhost:5050
Content-Type: application/json
Accept: application/json

{
  “type”        : “GET_VERSION”
}


GET_VERSION HTTP Response (JSON):

HTTP/1.1 200 OK

Content-Type: application/json

{
  “type”    : GET_VERSION,

  “get_version” : {
    “version_info” : {
      "version" : "1.0.0",
      "build_date" : "2016-06-24 23:18:37",
      "build_time" : 1466810317,
      "build_user" : "root"
    }
  }
}
</code></pre>

<h3>SET_LOGGING_LEVEL</h3>

<pre><code>SET_LOGGING_LEVEL HTTP Request (JSON):

POST /api/v1/  HTTP/1.1

Host: masterhost:5050
Content-Type: application/json
Accept: application/json

{
  “type”        : “SET_LOGGING_LEVEL”,

 “set_logging_level” : {

    “level” : 1,

    "duration" : {
      "nanoseconds" : 1224553
    }

  }
}

SET_LOGGING_LEVEL HTTP Response:

HTTP/1.1 200 Accepted
</code></pre>

<h2>Events</h2>

<p>Currently, the only call that results in a streaming response is the <code>SUBSCRIBE</code> call sent to the master API.</p>

<pre><code>SUBSCRIBE Request (JSON):

POST /api/v1/executor  HTTP/1.1

Host: agenthost:5051
Content-Type: application/json
Accept: application/json

{
  "type": "SUBSCRIBE",
}

SUBSCRIBE Response Event (JSON):
HTTP/1.1 200 OK

Content-Type: application/json
Transfer-Encoding: chunked

&lt;event-length&gt;
{
  "type": "SUBSCRIBED",

  "subscribed" : {

    "get_state" : {...}

  }

}
&lt;more events&gt;
</code></pre>

<p>The client is expected to keep a <strong>persistent</strong> connection open to the endpoint even after getting a <code>SUBSCRIBED</code> HTTP Response event. This is indicated by &ldquo;Connection: keep-alive&rdquo; and &ldquo;Transfer-Encoding: chunked&rdquo; headers with <em>no</em> &ldquo;Content-Length&rdquo; header set. All subsequent events generated by Mesos are streamed on this connection. Master encodes each Event in <a href="/documentation/latest/./scheduler-http-api/#recordio-response-format">RecordIO</a> format, i.e., string representation of length of the event in bytes followed by JSON or binary Protobuf encoded event.</p>

<p>The following events are currently sent by the master. The canonical source of this information is at <a href="https://github.com/apache/mesos/blob/master/include/mesos/v1/master/master.proto">master.proto</a>. Note that when sending JSON encoded events, master encodes raw bytes in Base64 and strings in UTF-8.</p>

<h3>SUBSCRIBED</h3>

<p>The first event sent by the master when a client sends a <code>SUBSCRIBE</code> request on the persistent connection. This includes a snapshot of the cluster state. See <code>SUBSCRIBE</code> above for details. Subsequent changes to the cluster state can result in more events (currently only <code>TASK_ADDED</code> and <code>TASK_UPDATED</code> are supported).</p>

<h3>TASK_ADDED</h3>

<p>Sent whenever a task has been added to the master. This can happen either when a new task launch is processed by the master or when an agent re-registers with a failed over master.</p>

<pre><code>TASK_ADDED Event (JSON)

&lt;event-length&gt;
{
  "type": "TASK_ADDED",

  "task_added": {
    "task": {
      "name": "dummy-task",
      "task_id": {
        "value": "d40f3f3e-bbe3-44af-a230-4cb1eae72f67"
      },
      "agent_id": {
        "value": "f1c9cdc5-195e-41a7-a0d7-adaa9af07f81"
      },
      "command": {
        "value": "sleep",
        "arguments": [
          "100"
        ]
      }
    }
  }
}
</code></pre>

<h3>TASK_UPDATED</h3>

<p>Sent whenever the state of the task changes in the master. This can happen when a status update is received or generated by the master. Since status updates are retried by the agent, not all status updates received by the master result in the event being sent.</p>

<pre><code>TASK_UPDATED Event (JSON)

&lt;event-length&gt;
{
  "type": "TASK_UPDATED",

  "task_updated": {
    "task_id": {
        "value": "42154f1b-adcd-4421-bf13-8bd11adfafaf"
    },

    "framework_id": {
        "value": "49154f1b-8cf6-4421-bf13-8bd11dccd1f1"
    },

    "agent_id": {
        "value": "2915adf-8aff-4421-bf13-afdafaf1f1"
    },

    "executor_id": {
        "value": "adfaf-adff-2421-bf13-adf23tafa21"
    },

    "state" : "TASK_RUNNING"
  }
}
</code></pre>

  </div>
</div>

  </div><!-- /.container -->
</div><!-- /.content -->

<hr>



    <!-- footer -->
    <div class="footer">
      <div class="container">
        <div class="col-md-4 social-blk">
          <span class="social">
            <a href="https://twitter.com/ApacheMesos"
              class="twitter-follow-button"
              data-show-count="false" data-size="large">Follow @ApacheMesos</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            <a href="https://twitter.com/intent/tweet?button_hashtag=mesos"
              class="twitter-hashtag-button"
              data-size="large"
              data-related="ApacheMesos">Tweet #mesos</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
          </span>
        </div>

        <div class="col-md-8 trademark">
          <p>&copy; 2012-2016 <a href="http://apache.org">The Apache Software Foundation</a>.
            Apache Mesos, the Apache feather logo, and the Apache Mesos project logo are trademarks of The Apache Software Foundation.
          <p>
        </div>
      </div><!-- /.container -->
    </div><!-- /.footer -->

    <!-- JS -->
    <script src="//code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js" type="text/javascript"></script>
  </body>
</html>
